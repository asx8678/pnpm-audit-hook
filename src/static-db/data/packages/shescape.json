{
  "name": "shescape",
  "lastUpdated": "2026-01-31T15:05:26.294Z",
  "vulnerabilities": [
    {
      "id": "GHSA-66pp-5p9w-q87j",
      "title": "Shescape has potential environment variable exposure on Windows with CMD",
      "description": "### Impact\n\nThis impact users of Shescape on Windows that explicitly configure `shell: 'cmd.exe'` or `shell: true` using any of `quote`/`quoteAll`/`escape`/`escapeAll`.\n\nAn attacker may be able to get read-only access to environment variables. Example:\n\n```javascript\nimport * as cp from \"node:child_process\";\nimport { Shescape } from \"shescape\";\n\n// 1. Prerequisites\nconst shescape = new Shescape({\n    shell: \"cmd.exe\",\n    // Or\n    shell: true, // Only if the default shell is CMD\n});\n\n// 2. Payl",
      "severity": "low",
      "url": "https://github.com/advisories/GHSA-66pp-5p9w-q87j",
      "publishedAt": "2025-03-26T14:54:22Z",
      "modifiedAt": "2025-03-26T14:54:23Z",
      "identifiers": [
        {
          "type": "GHSA",
          "value": "GHSA-66pp-5p9w-q87j"
        },
        {
          "type": "CVE",
          "value": "CVE-2025-30222"
        }
      ],
      "affectedRange": ">= 1.7.2, < 2.1.2",
      "fixedVersion": "2.1.2"
    },
    {
      "id": "GHSA-cr84-xvw4-qx3c",
      "title": "Inefficient Regular Expression Complexity in shescape ",
      "description": "### Impact\n\nThis impacts users that use shescape to escape arguments:\n\n- for the Unix shell Bash, or any not-officially-supported Unix shell;\n- using the `escape` or `escapeAll` functions with the `interpolation` option set to `true`.\n\nAn attacker can cause polynomial backtracking in terms of the input string length due to a Regular Expression in shescape that is vulnerable to Regular Expression Denial of Service (ReDoS). Example:\n\n```javascript\nimport * as shescape from \"shescape\";\n\n/* 1. Prere",
      "severity": "high",
      "url": "https://github.com/advisories/GHSA-cr84-xvw4-qx3c",
      "publishedAt": "2022-10-25T22:27:32Z",
      "modifiedAt": "2023-11-29T22:21:48Z",
      "identifiers": [
        {
          "type": "GHSA",
          "value": "GHSA-cr84-xvw4-qx3c"
        },
        {
          "type": "CVE",
          "value": "CVE-2022-25918"
        }
      ],
      "affectedRange": ">= 1.5.10, < 1.6.1",
      "fixedVersion": "1.6.1"
    },
    {
      "id": "GHSA-j55r-787p-m549",
      "title": "Shescape on Windows escaping may be bypassed in threaded context",
      "description": "### Impact\n\nThis may impact users that use Shescape on Windows in a threaded context (e.g. using [Worker threads](https://nodejs.org/api/worker_threads.html)). The vulnerability can result in Shescape escaping (or quoting) for the wrong shell, thus allowing attackers to bypass protections depending on the combination of expected and used shell.\n\nThis snippet demonstrates a vulnerable use of Shescape:\n\n```javascript\n// vulnerable.js\n\nimport { exec } from \"node:child_process\";\nimport { Worker, isM",
      "severity": "high",
      "url": "https://github.com/advisories/GHSA-j55r-787p-m549",
      "publishedAt": "2023-08-22T18:00:04Z",
      "modifiedAt": "2023-11-09T05:00:56Z",
      "identifiers": [
        {
          "type": "GHSA",
          "value": "GHSA-j55r-787p-m549"
        },
        {
          "type": "CVE",
          "value": "CVE-2023-40185"
        }
      ],
      "affectedRange": "< 1.7.4",
      "fixedVersion": "1.7.4"
    },
    {
      "id": "GHSA-3g7p-8qhx-mc8r",
      "title": "Shescape potential environment variable exposure on Windows with CMD",
      "description": "### Impact\n\nThis impact users of Shescape:\n\n1. On Windows using the Windows Command Prompt (i.e. `cmd.exe`), and\n2. Using `quote`/`quoteAll` or `escape`/`escapeAll` with the `interpolation` option set to `true`.\n\nAn attacker may be able to get read-only access to environment variables. Example:\n\n```javascript\nimport * as cp from \"node:child_process\";\nimport * as shescape from \"shescape\";\n\n// 1. Prerequisites\nconst options = {\n    shell: \"cmd.exe\",\n    // Or\n    shell: undefined, // Only if the d",
      "severity": "low",
      "url": "https://github.com/advisories/GHSA-3g7p-8qhx-mc8r",
      "publishedAt": "2023-06-22T20:01:39Z",
      "modifiedAt": "2023-11-07T05:02:07Z",
      "identifiers": [
        {
          "type": "GHSA",
          "value": "GHSA-3g7p-8qhx-mc8r"
        },
        {
          "type": "CVE",
          "value": "CVE-2023-35931"
        }
      ],
      "affectedRange": "< 1.7.1",
      "fixedVersion": "1.7.1"
    },
    {
      "id": "GHSA-446w-rrm4-r47f",
      "title": "Exposure of home directory through shescape on Unix with Bash",
      "description": "### Impact\n\nThe issue allows for exposure of the home directory on Unix systems when using Bash with the `escape` or `escapeAll` functions from the _shescape_ API with the `interpolation` option set to `true`. Other tested shells, Dash and Zsh, are not affected.\n\n```javascript\nconst cp = require(\"child_process\");\nconst shescape = require(\"shescape\");\n\nconst payload = \"home_directory=~\";\nconst options = { interpolation: true };\nconsole.log(cp.execSync(`echo ${shescape.escape(payload, options)}`))",
      "severity": "medium",
      "url": "https://github.com/advisories/GHSA-446w-rrm4-r47f",
      "publishedAt": "2022-03-03T19:26:11Z",
      "modifiedAt": "2023-06-27T18:37:05Z",
      "identifiers": [
        {
          "type": "GHSA",
          "value": "GHSA-446w-rrm4-r47f"
        },
        {
          "type": "CVE",
          "value": "CVE-2022-24725"
        }
      ],
      "affectedRange": ">= 1.4.0, < 1.5.1",
      "fixedVersion": "1.5.1"
    },
    {
      "id": "GHSA-jjc5-fp7p-6f8w",
      "title": "Shescape prior to 1.5.8 vulnerable to insufficient escaping of line feeds for CMD",
      "description": "### Impact\n\nThis impacts users that use Shescape (any API function) to escape arguments for **cmd.exe** on **Windows**. An attacker can omit all arguments following their input by including a line feed character (`'\\n'`) in the payload. Example:\n\n```javascript\nimport cp from \"node:child_process\";\nimport * as shescape from \"shescape\";\n\n// 1. Prerequisites\nconst options = {\n  shell: \"cmd.exe\",\n};\n\n// 2. Attack\nconst payload = \"attacker\\n\";\n\n// 3. Usage\nlet escapedPayload;\nescapedPayload = shescape",
      "severity": "high",
      "url": "https://github.com/advisories/GHSA-jjc5-fp7p-6f8w",
      "publishedAt": "2022-07-15T21:39:14Z",
      "modifiedAt": "2023-04-06T21:36:40Z",
      "identifiers": [
        {
          "type": "GHSA",
          "value": "GHSA-jjc5-fp7p-6f8w"
        },
        {
          "type": "CVE",
          "value": "CVE-2022-31179"
        }
      ],
      "affectedRange": "< 1.5.8",
      "fixedVersion": "1.5.8"
    },
    {
      "id": "GHSA-f2rp-38vg-j3gh",
      "title": "Null characters not escaped",
      "description": "### Impact\n\nAnyone using _Shescape_ to defend against shell injection may still be vulnerable against shell injection if the attacker manages to insert a [null character](https://en.wikipedia.org/wiki/Null_character) into the payload. For example (on Windows):\n\n```javascript\nconst cp = require(\"child_process\");\nconst shescape = require(\"shescape\");\n\nconst nullChar = String.fromCharCode(0);\nconst payload = \"foo\\\" && ls -al ${nullChar} && echo \\\"bar\";\nconsole.log(cp.execSync(`echo ${shescape.quote",
      "severity": "high",
      "url": "https://github.com/advisories/GHSA-f2rp-38vg-j3gh",
      "publishedAt": "2021-03-18T23:47:56Z",
      "modifiedAt": "2023-02-01T05:05:14Z",
      "identifiers": [
        {
          "type": "GHSA",
          "value": "GHSA-f2rp-38vg-j3gh"
        },
        {
          "type": "CVE",
          "value": "CVE-2021-21384"
        }
      ],
      "affectedRange": "< 1.1.3",
      "fixedVersion": "1.1.3"
    },
    {
      "id": "GHSA-44vr-rwwj-p88h",
      "title": "Shescape vulnerable to insufficient escaping of whitespace",
      "description": "### Impact\n\nThis only impacts users that use the `escape` or `escapeAll` functions with the `interpolation` option set to `true`. Example:\n\n```javascript\nimport cp from \"node:child_process\";\nimport * as shescape from \"shescape\";\n\n// 1. Prerequisites\nconst options = {\n  shell: \"bash\",\n  // Or\n  shell: \"dash\",\n  // Or\n  shell: \"powershell.exe\",\n  // Or\n  shell: \"zsh\",\n  // Or\n  shell: undefined, // Only if the default shell is one of the affected shells.\n};\n\n// 2. Attack (one of multiple)\nconst pa",
      "severity": "critical",
      "url": "https://github.com/advisories/GHSA-44vr-rwwj-p88h",
      "publishedAt": "2022-07-15T21:46:08Z",
      "modifiedAt": "2023-01-31T05:01:31Z",
      "identifiers": [
        {
          "type": "GHSA",
          "value": "GHSA-44vr-rwwj-p88h"
        },
        {
          "type": "CVE",
          "value": "CVE-2022-31180"
        }
      ],
      "affectedRange": ">= 1.4.0, < 1.5.8",
      "fixedVersion": "1.5.8"
    }
  ]
}